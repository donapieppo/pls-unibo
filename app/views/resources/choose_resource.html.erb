<div class="container" data-controller="resource">
  <h1 class="title">Scegli la risorsa</h1>

  <div class="my-2">
    <button data-action="click->resource#show_resources" data-resource-type-param="document" class="button">Documenti</button>
    <button data-action="click->resource#show_resources" data-resource-type-param="image" class="button">Immagini</button>
    <button data-action="click->resource#show_resources" data-resource-type-param="video" class="button">Video</button>
  </div>

  <% @resources.each do |t, resources| %>
    <div role="list" class="md:flex md:flex-wrap md:flex-row">
      <% resources.each do |resource| %>  
        <% hidden = (t != "document") ? "hidden" : "" %>
        <%= button_to [:add_resource, @what, {resource_id: resource.id}], form: {class: "bg-green-100 md:w-1/3 p-4 h-42 border-b-2 border-gray-100 #{hidden} border-2 border-orange-500", data: {type: t, "resource-target": "resource"}} do %>
          <% if t == "document" %>
            <%= attach_type_icon(resource.document.attachment.content_type) %>
            <%= resource %>
          <% elsif t == "image" %>
            <%= image_tag(resource.document.variant(resize_to_limit: [350, 350]), class: '') %>
          <% else %>
            <%= render Resource::ResourceComponent.new(resource) %>  
          <% end %>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>
