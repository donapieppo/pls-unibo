<div class="p-2">
  <%= simple_form_for [@project, @edition] do |f| %>  
    <%= f.input :hidden, as: :boolean %>  
    <%= f.input :in_evidence, as: :boolean %>  
    <%= f.input :academic_year, collection: (2016...2022).to_a.reverse, include_blank: false %>
    <%= f.input :name %>  
    <%= f.input :description, input_html: { cols: 80, rows: 5 } %>

    <div class="details-trix-editor">
      <label>
        Descrizione più dettagliata con la possibilità di formattare il testo (opzionale)
      </label>
      <%= f.rich_text_area :details %>
    </div>

    <%= f.association :audience, include_blank: false %>  

    <%= f.input :seats %>

    <div class="my-2">
      <%= f.input :sofia %>
      <%= f.input :pcto %>
    </div>

    <%= f.input :atomic %>

    <%= f.input :in_presence %>
    <div id="if_in_presence">
      <%= f.input :place %>
      <%= f.input :google_map, as: :string, placeholder: 'https://' %>
    </div>

    <%= f.input :online %>
    <div id="if_online">
      <%= f.input :access_url, as: :string, placeholder: 'https://' %>
    </div>

    <%= f.input :bookable, collection: [['no', 'no'], ['si', 'yes'], ['da confermare', 'to_confirm'], ['esterne', 'external']], include_blank: false %>
    <div id="booking_url">
      <%= f.input :booking_url, hint: "In caso di sofia #{SOFIA_LINK}" %>
    </div>
    <div id="booking_dates">
      <%= f.input :booking_start, minute_step: 10 %>
      <%= f.input :booking_end, minute_step: 10 %>
      <% siblings = @edition.cluster_siblings %>  
      <% if siblings.any? %>  
        <hr class="my-2"/>
        <div>
          <%= exclamation_icon %>  Nota: iscrizioni uniche con 
          <ul>
          <% siblings.each do |activity| %>
            <li><%= link_to activity.to_s, activity %> </li>
          <% end %>
          </ul>
        </div>
      <% end %>
    </div>
    <%= f.submit %>  
  <% end %>
</div>

<%= javascript_tag do %>  
  document.addEventListener('DOMContentLoaded', (event) => {
    display_unless('no', document.getElementById('booking_dates'), document.getElementById('edition_bookable'));
    display_if('external', document.getElementById('booking_url'), document.getElementById('edition_bookable'));
    display_if_checked(document.getElementById('if_in_presence'), document.getElementById('edition_in_presence'));
    display_if_checked(document.getElementById('if_online'), document.getElementById('edition_online'));
  });
<% end %>
